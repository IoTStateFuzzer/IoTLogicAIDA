# BTB Semantic
```json
{
    "local_user1_AddDevice": [
        [
            "Operation result: Success. Evidence: **'status':0,'msg':'ok''**. Reason: HTTP 200 response with success status (0) and confirmation message ('ok') consistently across all reports confirms successful device operation."
        ]
    ],
    "local_user1_DeviceControl": [
        [
            "Operation result: Undetermined. Evidence: 'Abs_Len28|lu'; 'No decisive payload evidence or clear traffic patterns'. Reason: Traffic analysis shows only length indicators (Abs_Len28) without operation-specific content, error codes, or success confirmation patterns in encrypted UDP streams"
        ]
    ],
    "local_user1_InviteToHome": [
        [
            "Operation result: Success. Evidence: ''error':0,'status':0,'msg':'ok','data':{'qrcode':'11Abs_Len14|'}'. Reason: HTTP 200 with success status and QR code generation confirms invitation success."
        ],
        [
            "Operation result: Success. Evidence: ''error':0,'status':0,'msg':'ok','data':{'qrcode':'11Abs_Len14|}'. Reason: Successful QR code generation and family member list update confirm invitation completion."
        ]
    ],
    "local_user1_RemoveDevice": null,
    "local_user1_RemoveFromHome": [
        [
            "Operation result: Success. Evidence: '/appsync/group/member/delfamilymember' + '{'error':0,'status':0,'msg':'ok'}'; 'FPSPER{'error':0,'status':0,'msg':'ok'}'. Reason: Consistent success confirmation across all reports with HTTP POST to deletion endpoint returning success status codes (error:0, status:0) and confirmation message ('ok')"
        ]
    ],
    "local_user2_DeviceControl": [
        [
            "Operation result: Success. Evidence: 'status':0'; 'Response' messages with payload data. Reason: HTTP 200 equivalent status with status:0 and sustained control responses confirm successful device operation (majority consensus). Note: One report lacked explicit control confirmation."
        ],
        [
            ""
        ],
        [
            ""
        ],
        [
            ""
        ],
        [
            ""
        ],
        [
            "Operation result: Undetermined. Evidence: 'UDP traffic pattern'; 'UDP packets with no decipherable content'. Reason: Encrypted UDP traffic patterns present but lack protocol-level success/failure indicators (unanimous consensus)."
        ]
    ],
    "remote_user1_DeviceControl": null,
    "remote_user2_AcceptInvite": [
        [
            "Operation result: Success. Evidence: ''error':0,'status':0,'msg':'ok','data':{'familyid':'11b9af345feef8afb71de0053611d0eb'}'; '/appsync/group/member/invited/joinfamily|||||FPSPER{'error':0,'status':0,'msg':'ok'}'. Reason: Consistent HTTP 200 responses with success status (0), 'ok' messages, and confirmed family ID acceptance across all reports."
        ]
    ],
    "remote_user2_DeviceControl": [
        [
            ""
        ],
        [
            "Operation result: Success. Evidence: ''name':'Response''; 'POST|/device/control/v2/sdkcontrol'; 'namespace':'DNA.TransmissionControl','name':'Response'. Reason: Multiple successful responses with consistent payload structure and sustained bidirectional HTTP traffic confirming successful control operations."
        ],
        [
            ""
        ],
        [
            "Operation result: Failed. Evidence: ''name':'ErrorResponse', 'message':'device reset, please rebind''; 'ErrorResponse' + 'device reset, please rebind' + status:-7; 'namespace':'DNA.TransmissionControl','name':'ErrorResponse','message':'device reset, please rebind'. Reason: Consistent error responses indicating device reset condition with rebind requirement, supported by multiple error payloads and status code -7."
        ]
    ],
    "remote_user2_QuitHome": [
        [
            "Operation result: Success. Evidence: '/appsync/group/member/quitfamily|||||FPSPER{'error':0,'status':0,'msg':'ok'}'. Reason: Consistent HTTP 200 status with 'ok' message across all reports confirms successful quitfamily operation."
        ],
        [
            "Operation result: Success. Evidence: '/appsync/group/member/quitfamily|||||FPSPER{'error':0,'status':0,'msg':'ok'}'. Reason: Repeated confirmation of HTTP 200 status with 'ok' message validates successful quitfamily operation despite noted device errors."
        ],
        [
            ""
        ],
        [
            ""
        ],
        [
            ""
        ],
        [
            "Operation result: Failed. Evidence: '/appsync/group/member/quitfamily|||||FPSPER{'status':-30107,'msg':'\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd'}'. Reason: Unanimous negative status code (-30107) with error message indicates definitive quitfamily operation failure."
        ]
    ],
    "remote_user2_ScanQRCode": [
        [
            "Operation result: Success. Evidence: '{'error':0,'status':0,'msg':'ok'}'. Reason: HTTP 200 response with success status code and message confirmation."
        ],
        [
            "Operation result: Failed. Evidence: '{'error':-2010,'status':-2010,'msg':'\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd'}'. Reason: Negative error code (-2010) with garbled message indicates authentication or system failure."
        ],
        [
            "Operation result: Failed. Evidence: '{'error':-2011,'status':-2011,'msg':'\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd\ufffd'}'. Reason: Negative error code (-2011) with extended garbled message indicates critical system failure."
        ]
    ]
}
```

# State Semantic
## Base model
| State | Semantic Description |
|-------|----------------------|
| S0    | Initial state. |
| S1    | Error state. |
| S2    | user1 added the device; user2 has no permissions. |
| S3    | user1 added the device and invited user2 to become a family member; user2 has not accepted yet. |
| S4    | user1 invited user2 to become a family member; user2 has not accepted yet. |
| S5    | user1 added the device and invited user2 to become a family member; user2 scanned the QR code but has not accepted yet. |
| S6    | user1 added the device and invited user2 to become a family member; user2 accepted the invitation and is now a family member with control permissions. |
| S7    | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation and is now a family member with control permissions. |
| S8    | user1 invited user2 to become a family member; user2 accepted the invitation and is now a family member with control permissions. |
| S9    | user1 invited user2 to become a family member twice; user2 accepted the second invitation and is now a family member with control permissions. |
| S10   | user1 invited user2 to become a family member; user2 scanned the QR code but has not accepted yet. |
| S11   | user1 invited user2 to become a family member twice; user2 accepted the second invitation and was then removed from the family by user1. |
| S12   | user1 invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, and user1 re-added the device. |
| S13   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation and was then removed from the family by user1. |
| S14   | user1 added the device and invited user2 to become a family member; user2 accepted the invitation and was then removed from the family by user1. |
| S15   | user1 added the device and invited user2 to become a family member; user2 accepted the invitation, was removed from the family, and user1 removed the device. |
| S16   | user1 invited user2 to become a family member; user2 accepted the invitation and was then removed from the family by user1. |
| S17   | user1 invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 re-added the device, and user2 scanned the QR code again. |
| S18   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, and user2 scanned the QR code again. |
| S19   | user1 invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, and user2 scanned the QR code again. |
| S20   | user1 added the device and invited user2 to become a family member; user2 accepted the invitation and then quit the family. |
| S21   | user1 added the device and invited user2 to become a family member; user2 accepted the invitation, was removed from the family, user1 removed and re-added the device. |
| S22   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 removed and re-added the device. |
| S23   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 removed and re-added the device, and user2 scanned the QR code again. |
| S24   | user1 invited user2 to become a family member; user2 accepted the invitation, was removed from the family, and user1 re-added the device. |
| S25   | user1 invited user2 to become a family member; user2 accepted the invitation and then quit the family. |
| S26   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, and user1 removed the device. |
| S27   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 removed the device, and user2 scanned the QR code again. |
| S28   | user1 invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 re-added the device, user2 scanned the QR code again, and user1 re-invited user2. |
| S29   | user1 invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user2 scanned the QR code again, and user1 re-invited user2. |
| S30   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user2 scanned the QR code again, and user1 re-invited user2. |
| S31   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 removed the device, user2 scanned the QR code again, and user1 re-invited user2. |
| S32   | user1 added the device and invited user2 to become a family member twice; user2 accepted the second invitation, was removed from the family, user1 removed and re-added the device, user2 scanned the QR code again, and user1 re-invited user2. |
| S33   | user1 invited user2 to become a family member twice; user2 has not accepted yet. |
| S34   | user1 added the device and invited user2 to become a family member twice; user2 has not accepted yet. |

# Bug Reports
## Base model
*   **Issue Description:** Inconsistent error handling and potential information leakage through error messages.
    *   **Problematic State(s):**
        *   `s6`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S6**, causing potential information leakage through garbled error message.
        *   `s7`: Performed **user2|remote|ScanQRCode**, received **{'error':-2011,'status':-2011,'msg':'������������������������������'}**, transitioned to **State S7**, causing potential information leakage through extended garbled error message.
        *   `s8`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S8**, causing potential information leakage through garbled error message.
        *   `s9`: Performed **user2|remote|ScanQRCode**, received **{'error':-2011,'status':-2011,'msg':'������������������������������'}**, transitioned to **State S9**, causing potential information leakage through extended garbled error message.
        *   `s14`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S14**, causing potential information leakage through garbled error message.
        *   `s15`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S15**, causing potential information leakage through garbled error message.
        *   `s16`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S16**, causing potential information leakage through garbled error message.
        *   `s20`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S20**, causing potential information leakage through garbled error message.
        *   `s21`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S21**, causing potential information leakage through garbled error message.
        *   `s24`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S24**, causing potential information leakage through garbled error message.
        *   `s25`: Performed **user2|remote|ScanQRCode**, received **{'error':-2010,'status':-2010,'msg':'������������������'}**, transitioned to **State S25**, causing potential information leakage through garbled error message.

*   **Issue Description:** Potential unauthorized device control due to inconsistent permission checks.
    *   **Problematic State(s):**
        *   `s13`: Performed **user2|remote|DeviceControl**, received **Success**, transitioned to **State S13**, causing potential unauthorized device control as user2 was removed from the family.
        *   `s14`: Performed **user2|remote|DeviceControl**, received **Success**, transitioned to **State S14**, causing potential unauthorized device control as user2 was removed from the family.
        *   `s18`: Performed **user2|remote|DeviceControl**, received **Success**, transitioned to **State S18**, causing potential unauthorized device control as user2 was removed from the family.
        *   `s30`: Performed **user2|remote|DeviceControl**, received **Success**, transitioned to **State S30**, causing potential unauthorized device control as user2 was removed from the family.

*   **Issue Description:** System ignores User2's QuitHome requests after family removal, maintaining hidden membership states and revealing state inconsistency.
    *   **Problematic State(s):**
        *   `s11/s12/s13`: User2's **QuitHome** requests return consistent failures (**CLS_5 Failed**) despite having no valid membership, revealing state inconsistency.