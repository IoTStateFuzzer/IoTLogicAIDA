# BTB Semantic
```json
{
    "local_user1_AddDevice": null,
    "local_user1_DeviceControl": [
        [
            "Operation result: Undetermined. Evidence: 'multiple MQTT packets'. Reason: Consensus indicates partial or indefinite traffic with no explicit success or error signals. A minority references sustained exchange without abrupt termination, but it does not override the unclear outcome."
        ]
    ],
    "local_user1_RemoveDevice": [
        [
            "Operation result: Success. Evidence: ''type':'del''. Reason: The device reset command was acknowledged as successful and included a 'del' action indicating removal."
        ]
    ],
    "local_user1_SharePlug": [
        [
            "Operation result: Failed. Evidence: 'REPETITION_SHARE'. Reason: The error indicates the device was already shared."
        ],
        [
            "Operation result: Success. Evidence: 'success':true. Reason: The add sharing call returned a successful status, acknowledging user2 as the recipient."
        ]
    ],
    "local_user1_UnsharePlug": [
        [
            "Operation result: Success. Evidence: '/sharing/device/remove' 'success':true. Reason: The remove API returned 'success':true, verifying unsharing was completed."
        ]
    ],
    "local_user2_DeviceControl": [
        [
            "Operation result: Undetermined. Evidence: 'single TCP packet'. Reason: Insufficient data from a single packet to confirm success or error"
        ],
        [
            "Operation result: Success. Evidence: ''. Reason: Sustained multi-packet transmissions with no error signals indicate successful device control"
        ]
    ],
    "remote_user2_DeviceControl": [
        [
            "Operation result: Undetermined. Evidence: . Reason: Absence of explicit success or error codes, with indications of successful signaling not conclusively confirming success"
        ],
        [
            "Operation result: Undetermined. Evidence: . Reason: Only a single packet observed without definitive success or failure indicators"
        ]
    ]
}
```

# State Semantic
## Base model
| State | Semantic Description |
|-------|----------------------|
| 0     | Initial state. No device is bound by user1, and user2 has no membership or permission. |
| 1     | user1 has added the device once; user2 is not invited and holds no control rights. |
| 2     | Error state. |
| 3     | user1 has added the device once and shared it directly with user2; user2 automatically holds direct control permissions for this device. |

## Divergent model
| State | Semantic Description |
|-------|----------------------|
| 0     | Initial state. No device is bound to user1; user2 has no permissions. |
| 1     | user1 has added the device once; user2 has no permissions. |
| 2     | Error state. |
| 3     | user1 has added the device once and shared it with user2, granting user2 direct control permissions. |
| 4     | user1 has added the device once and shared it with user2; user2 performed a control action (outcome unknown) but retains direct control permissions. |
| 5     | user1 unshared the device from user2, revoking user2’s direct permission. |
| 6     | user1 removed the device; user2’s permission is void. |

# Bug Reports
## Base model
No issues found.

## Divergent model
*   **Vulnerability 1: Unauthorized device control attempt after permission revocation**
*   **Impact:** user2 may retain (or at least not be clearly denied) control capability despite revoked permissions, jeopardizing device integrity and undermining user1’s intended access policy.
*   **Problematic State(s):**
    *   `s5`: Performed user2|remote|DeviceControl / Symbol: CLS_1, outcome “Undetermined”; user2’s permission was already revoked, creating a risk of unauthorized control.  
    *   `s6`: Performed user2|remote|DeviceControl / Symbol: CLS_1, outcome “Undetermined”; user2’s permission is void, yet the operation lacks a definitive rejection.