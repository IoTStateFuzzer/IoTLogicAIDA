# BTB Semantic
```json
{
    "local_user1_AddDevice": null,
    "local_user1_DeviceControl": [
        [
            "Operation result: Success. Evidence: 'code':200,'success':true'; 'code:200' + 'success':true'; ''code':200,'success':true'; 'code:200, success:true'; 'code=200','success':true'. Reason: The HTTP 200 code with success=true confirms device control was performed successfully."
        ]
    ],
    "local_user1_RemoveDevice": [
        [
            "Operation result: Success. Evidence: 'code=200','success=true'. Reason: The server indicated removal succeeded with a 200 status and success flag"
        ]
    ],
    "local_user1_SharePlug": [
        [
            "Operation result: Success. Evidence: 'code=200,success=true'. Reason: The returned code=200 with success=true indicates a successful share request."
        ],
        [
            "Operation result: Failed. Evidence: 'success=false'. Reason: The share request reported success=false indicating the operation did not complete."
        ]
    ],
    "local_user1_UnsharePlug": [
        [
            "Operation result: Success. Evidence: ''. Reason: The request responded with code=200 and success=true indicating the unshare action was successful."
        ]
    ],
    "remote_user2_AcceptDeviceShare": [
        [
            ""
        ],
        [
            "Operation result: Success. Evidence: '**'code=200,success=true'**'; '**'code':200,'success':true**'; '**'code=200','success=true'**'; '**'code=200 success=true'**'; '**'code=200,success=true'**'. Reason: The response with code=200 and success=true indicates acceptance."
        ],
        [
            "Operation result: Failed. Evidence: '**'success=false'**'; '**'success':false**'; '**'success=false'**'; '**'success=false'**'; '**'success=false'**'. Reason: The response with success=false indicates rejection."
        ],
        [
            "Operation result: Failed. Evidence: '**'success=false'**'; '**'success':false**'; '**'success=false'**'; '**'success=false'**'; '**'success=false'**'. Reason: The response with success=false indicates rejection."
        ]
    ],
    "remote_user2_DeviceControl": [
        [
            "Operation result: Success. Evidence: 'code=200'. Reason: A 200 code indicates the operation was successful."
        ],
        [
            ""
        ],
        [
            "Operation result: Failed. Evidence: ''. Reason: Code 9017 or success=false indicates the operation failed."
        ]
    ]
}
```

# State Semantic
## Base model
| State | Semantic Description                                                                                   |
|-------|--------------------------------------------------------------------------------------------------------|
| 0     | Initial state.                                                                                        |
| 1     | user1 has added the device once; user2 has not been invited.                                          |
| 2     | Error state.                                                                                          |
| 3     | user1 has added the device once and directly shared it with user2, but user2 has not accepted.        |
| 4     | user1 has added the device once; user2 has accepted the direct device share and now has control.      |

## Divergent model
| State | Semantic Description |
|-------|----------------------|
| 0     | Initial state. No device is added, and no permissions exist. |
| 1     | User1 has added the device once; user2 is not invited and has no permissions. |
| 2     | Error state. |
| 3     | User1 has the device (1st addition) and has invited user2 for direct sharing; user2’s invitation is pending acceptance. |
| 4     | User1 has the device (1st addition); user2 has accepted the direct share and now controls the device. |
| 5     | User1 still has the device (1st addition). user2, having accepted the direct share, is actively controlling it. |
| 6     | User1 still has the device (1st addition), but user2’s direct sharing permission is revoked; user2 no longer has control. |
| 7     | User1 still has the device (1st addition) and has re-shared it with user2; user2 is newly invited but has not accepted yet. |
| 8     | User1 removed the device from the account; user2’s direct share is invalidated because the device is no longer available. |

# Bug Reports
## Base model
No issues found.

## Divergent model
*   **Vulnerability 1: Unauthorized Device Control in Revoked or Unaccepted States**  
*   **Impact:** Across multiple reports, user2 retains or gains the ability to operate the device (DeviceControl) despite having no valid permission—either because the share was revoked (State s6) or the invitation was never accepted (State s7). This violates standard access-control rules (CWE-284 / CWE-863), compromises device integrity and availability, and represents a clear breach of the intended permission model.  
*   **Problematic State(s):**
    *   `s6`: Performed user2|remote|DeviceControl, received “Success,” enabling continued device operation despite the share having been revoked.  
    *   `s7`: Performed user2|remote|DeviceControl, received “Success,” granting unauthorized control before the invitation was accepted.