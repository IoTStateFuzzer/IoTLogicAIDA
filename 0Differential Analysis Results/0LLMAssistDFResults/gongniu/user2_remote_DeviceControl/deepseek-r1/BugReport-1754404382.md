# BTB Semantic
```json
{
    "local_user1_AddDevice": null,
    "local_user1_DeviceControl": [
        [
            "Operation result: Success. Evidence: 'code:200'; 'success:true'. Reason: Control command execution confirmed by HTTP 200 status code and explicit boolean success flag in payload, indicating acknowledged device state change."
        ]
    ],
    "local_user1_RemoveDevice": [
        [
            "Operation result: Success. Evidence: 'code':200; 'success':true'. Reason: DELETE operation to device endpoint returned HTTP 200 status and explicit success boolean in payload, confirming device removal. Absence of localized traffic in one instance due to packet discard policies does not contradict success indicators."
        ]
    ],
    "local_user1_SharePlug": [
        [
            "Operation result: Success. Evidence: 'POST /mos/share/v1/devices'; 'success':true'; 'code':200'. Reason: Successful sharing operation confirmed through API response status 200 and explicit payload success indicator."
        ],
        [
            "Operation result: Failed. Evidence: 'POST /mos/share/v1/devices'; 'success':false'. Reason: Sharing endpoint response contains definitive failure marker (success=false) in payload."
        ]
    ],
    "local_user1_UnsharePlug": [
        [
            "Operation result: Success. Evidence: 'POST /mos/share/v1/devices/cancel' and '{'code':200,'success':true}'. Reason: Cancel share operation succeeded with consensus on API endpoint '/mos/share/v1/devices/cancel' showing HTTP 200 code and explicit 'success:true' payload. All reports confirmed successful authentication and response validation without error indications."
        ]
    ],
    "remote_user2_AcceptDeviceShare": null,
    "remote_user2_DeviceControl": [
        [
            "Operation result: Failed. Evidence: 'code':9017,'success':false'. Reason: Command rejected at device level with explicit failure code 9017 and false success indicator."
        ],
        [
            ""
        ],
        [
            ""
        ]
    ]
}
```

# State Semantic
## Base model

| State | Semantic Description |
|-------|----------------------|
| 0 | Initial state: user1 has not added the device; user2 is not a family member and has no permissions. |
| 1 | user1 added the device once; user2 is not a family member and has no permissions. |
| 2 | Error state. |
| 3 | user1 added the device once and shared it via direct device sharing; user2 is not a family member and has a pending (unaccepted) invitation, and has no permissions. |
| 4 | user1 added the device once and shared it via direct device sharing; user2 is not a family member, accepted the invitation, and has control permissions for this device instance. |

## Divergent model
| State | Semantic Description |
|-------|----------------------|
| S0    | Initial state. |
| S1    | user1 added the device once; user2 has no permissions. |
| S2    | Error state. |
| S3    | user1 directly shared the device; user2 has not accepted the invitation. |
| S4    | user2 accepted direct sharing and has temporary control permissions for the current device instance. |
| S5    | user2 retains direct sharing permissions despite device-level control failure (error 9017). |
| S6    | user1 revoked direct sharing; user2 lost temporary control rights. |
| S7    | user1 re-shared the device via direct sharing; user2 must accept to regain permissions. |
| S8    | user1 removed the device; user2â€™s direct sharing permissions are permanently revoked. |

# Bug Reports
## Base model
*   No issues found.

## Divergent model
*   **Vulnerability 1: Differential Inference of Device Removal Status via Error Code Leakage**
    *   **Impact:** Allows unauthorized inference of device removal status through distinct error response patterns (CLS_2 symbol), violating system state confidentiality and Principle 2 (Differential Inference). Attackers can distinguish between temporary permission revocation (CLS_0 with code 9017), device-level failures (CLS_0/CLS_1), and permanent device removal (CLS_2), leaking information about device lifecycle changes and system state transitions.
    *   **Problematic State(s):**
        *   `s8`: Performed **user2|remote|DeviceControl**, received **Symbol: CLS_2** (distinct from CLS_0/CLS_1 responses in other unauthorized states), transitioned to **State S8**, causing **leakage of device removal status through unique error code differentiation**. The distinct response pattern enables attackers to conclusively determine when a device has been permanently removed versus experiencing temporary access issues.